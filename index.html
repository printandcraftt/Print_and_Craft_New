<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Print & Craft üíú</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&display=swap" rel="stylesheet">

<style>
*{
margin:0;
padding:0;
box-sizing:border-box;
font-family:'Poppins',sans-serif;
transition:.3s;
}

body{
background:#f5f0ff;
color:#333;
}

/* NAV */
nav{
background:white;
padding:15px 20px;
display:flex;
justify-content:space-between;
align-items:center;
position:sticky;
top:0;
z-index:1000;
box-shadow:0 5px 15px rgba(0,0,0,0.05);
}

.logo{
font-weight:800;
font-size:18px;
color:#6a00f4;
}

nav ul{
list-style:none;
display:flex;
gap:20px;
align-items:center;
}

nav a{
text-decoration:none;
color:#6a00f4;
font-weight:600;
font-size:14px;
}

#darkToggle{
background:#6a00f4;
color:white;
border:none;
padding:6px 14px;
border-radius:20px;
cursor:pointer;
}

/* HERO */
.hero{
background:linear-gradient(135deg,#6a00f4,#9d4edd);
color:white;
text-align:center;
padding:80px 20px;
}

/* PRODUCTS */
.products{
padding:60px 20px;
text-align:center;
}

.products h2{
color:#6a00f4;
margin-bottom:40px;
}

.grid{
display:grid;
grid-template-columns:repeat(auto-fit,minmax(180px,1fr));
gap:20px;
}

.product{
background:white;
border-radius:15px;
overflow:hidden;
box-shadow:0 10px 25px rgba(0,0,0,0.08);
}

.product img{
width:100%;
height:200px;
object-fit:cover;
}

.product h3{
margin-top:10px;
color:#6a00f4;
}

.product p{
font-size:13px;
padding:0 15px 15px;
color:#555;
}

.view-btn{
background:#6a00f4;
color:white;
padding:14px 30px;
border-radius:30px;
text-decoration:none;
display:inline-block;
margin-top:40px;
}

/* REVIEWS */
.reviews-section{
padding:60px 20px;
text-align:center;
background:#fff;
}

.reviews-grid{
max-width:900px;
margin:0 auto;
}

.review-card{
background:#f5f0ff;
padding:20px;
border-radius:15px;
margin-bottom:20px;
}

.review-form{
max-width:400px;
margin:30px auto 0;
display:flex;
flex-direction:column;
gap:15px;
}

.review-form input,
.review-form textarea{
padding:12px;
border-radius:10px;
border:1px solid #ddd;
}

.review-form button{
padding:12px;
border:none;
border-radius:25px;
background:#6a00f4;
color:white;
font-weight:600;
cursor:pointer;
}

.stars{
display:flex;
justify-content:center;
gap:8px;
}

.stars span{
font-size:22px;
cursor:pointer;
opacity:.4;
}

.stars span.active{
opacity:1;
}

/* PROMO */
.promo-popup{
position:fixed;
inset:0;
background:rgba(0,0,0,.7);
display:none;
justify-content:center;
align-items:center;
z-index:99999;
}

.promo-box{
background:white;
padding:30px;
border-radius:20px;
text-align:center;
width:340px;
position:relative;
}

.close-btn{
position:absolute;
top:10px;
right:15px;
font-size:22px;
cursor:pointer;
color:#6a00f4;
}

.wheel{
width:240px;
height:240px;
border-radius:50%;
margin:20px auto;
border:6px solid #6a00f4;
background:conic-gradient(
#6a00f4 0deg 90deg,
#bb86fc 90deg 180deg,
#9d4edd 180deg 270deg,
#e0aaff 270deg 360deg
);
position:relative;
transition:transform 4s ease-out;
}

.wheel div{
position:absolute;
width:100%;
text-align:center;
top:50%;
left:50%;
transform-origin:center;
color:white;
font-weight:600;
}

.label1{ transform:rotate(45deg) translate(-50%,-100px); }
.label2{ transform:rotate(135deg) translate(-50%,-100px); }
.label3{ transform:rotate(225deg) translate(-50%,-100px); }
.label4{ transform:rotate(315deg) translate(-50%,-100px); }

#spinBtn{
padding:10px 25px;
border:none;
border-radius:25px;
background:#6a00f4;
color:white;
font-weight:600;
cursor:pointer;
}

/* DARK MODE */
body.dark{
background:#121212;
color:#f1f1f1;
}
body.dark nav,
body.dark .reviews-section{
background:#1e1e1e;
}
body.dark .product,
body.dark .review-card{
background:#1f1f1f;
color:white;
}
body.dark input,
body.dark textarea{
background:#1f1f1f;
color:white;
border:1px solid #444;
}

/* MOBILE */
@media(max-width:768px){
.grid{
grid-template-columns:repeat(2,1fr);
}
.product img{
height:150px;
}
.promo-box{
width:90%;
}
}
</style>
</head>
<body>
<!-- ================= NAVIGATION ================= -->
<nav>
  <div class="logo">Print & Craft üíú</div>
  <ul>
    <li><a href="products.html">Products</a></li>
    <li><a href="reviews.html">All Reviews</a></li>
    <li><a href="admin.html">Admin</a></li>
    <li><button id="darkToggle">üåô</button></li>
  </ul>
</nav>

<!-- ================= HERO ================= -->
<section class="hero">
  <h1>Handmade Gifts That Speak Love üíú</h1>
  <p>Create unforgettable memories with our custom crafts made with heart and passion.</p>
</section>

<!-- ================= PRODUCTS ================= -->
<section class="products">
  <h2>Our Products ‚ú®</h2>

  <div class="grid">

    <div class="product">
      <img src="images/bouquet/Bouquet.jpg">
      <h3>Fuzzywire Bouquet</h3>
      <p>Handmade fuzzy wire flower bouquet perfect for birthdays and surprises.</p>
    </div>

    <div class="product">
      <img src="images/polaroid/Polaroid.jpg">
      <h3>Polaroid Prints</h3>
      <p>High-quality polaroid prints to capture your best memories.</p>
    </div>

    <div class="product">
      <img src="images/box set/Box set.jpg">
      <h3>Polaroid Box Set</h3>
      <p>Complete 45-piece custom polaroid collection inside a premium gift box.</p>
    </div>

    <div class="product">
      <img src="images/bracelet/Bracelet.jpg">
      <h3>Bracelet</h3>
      <p>Customized beaded bracelets for couples, friends, and loved ones.</p>
    </div>

    <div class="product">
      <img src="images/keychain/Keychain.jpg">
      <h3>Keychain</h3>
      <p>Personalized keychains to carry your favorite photo everywhere.</p>
    </div>

    <div class="product">
      <img src="images/frame/Frame.jpg">
      <h3>Photo Frame</h3>
      <p>Spotify-style music photo frame gift idea for special occasions.</p>
    </div>

    <div class="product">
      <img src="images/Photostrips/PhotoStrips.jpg">
      <h3>Photostrips</h3>
      <p>Mini photo booth strips perfect for cute and fun memories.</p>
    </div>

  </div>

  <a href="products.html" class="view-btn">View All Products üíú</a>
</section>

<!-- ================= PROMO POPUP ================= -->
<div class="promo-popup" id="promoPopup">
  <div class="promo-box">

    <div class="close-btn" id="closePromo">‚úï</div>

    <h3>Spin & Win üéâ</h3>

    <div class="wheel" id="wheel">
      <div class="label1">5% OFF</div>
      <div class="label2">10% OFF</div>
      <div class="label3">20% OFF</div>
      <div class="label4">LOSE</div>
    </div>

    <button id="spinBtn">SPIN</button>

    <p id="spinResult" style="margin-top:15px;font-weight:600;"></p>

  </div>
</div>
<!-- ================= REVIEWS SECTION ================= -->
<section class="reviews-section">
  <h2>Customer Feedback üíú</h2>

  <div class="average-box">
    <span id="averageRating">0.0</span> ‚≠ê
    <p>Average Rating</p>
  </div>

  <div id="reviewsContainer" class="reviews-grid"></div>

  <a href="reviews.html" class="view-btn" style="margin-bottom:40px;">View All Reviews üíú</a>

  <h3 style="margin-top:40px;">Leave a Review ‚ú®</h3>

  <form id="reviewForm" class="review-form">
    <input type="text" id="name" placeholder="Your Name" required>

    <div class="stars">
      <span data-value="1">‚≠ê</span>
      <span data-value="2">‚≠ê</span>
      <span data-value="3">‚≠ê</span>
      <span data-value="4">‚≠ê</span>
      <span data-value="5">‚≠ê</span>
    </div>

    <textarea id="reviewText" placeholder="Write your review..." required></textarea>

    <button type="submit">Submit Review üíú</button>
  </form>
</section>

<footer>
  <p>Made with üíú by Print & Craft</p>
</footer>

<!-- ================= FIREBASE + MAIN SCRIPT ================= -->
<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
import { 
  getFirestore, 
  collection, 
  addDoc, 
  getDocs, 
  query, 
  orderBy 
} from "https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyCCMd6565SLeJx0zCM5h8bkj5UzSBZeQcA",
  authDomain: "print-craft-9d708.firebaseapp.com",
  projectId: "print-craft-9d708",
  storageBucket: "print-craft-9d708.firebasestorage.app",
  messagingSenderId: "873230926106",
  appId: "1:873230926106:web:464e08d3ce7d111b6aeca3"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

window.db = db;

/* ================= DARK MODE ================= */

const toggle = document.getElementById("darkToggle");

if(localStorage.getItem("darkMode")==="enabled"){
  document.body.classList.add("dark");
}

toggle.addEventListener("click",()=>{
  document.body.classList.toggle("dark");
  localStorage.setItem("darkMode",
    document.body.classList.contains("dark")?"enabled":"disabled");
});
/* ================= REVIEW SYSTEM ================= */

let selectedRating = 0;
const stars = document.querySelectorAll(".stars span");

stars.forEach(star=>{
  star.addEventListener("click",()=>{
    selectedRating = star.dataset.value;
    stars.forEach(s=>s.classList.remove("active"));
    for(let i=0;i<selectedRating;i++){
      stars[i].classList.add("active");
    }
  });
});

function maskName(name){
  if(name.length <= 2) return name;
  return name.substring(0,2) + "****";
}

async function loadReviews(){

  const container = document.getElementById("reviewsContainer");
  container.innerHTML = "";

  let total = 0;
  let count = 0;

  const q = query(collection(db,"reviews"),orderBy("createdAt","desc"));
  const snapshot = await getDocs(q);

  const docs = snapshot.docs.slice(0,3);

  docs.forEach(doc=>{
    const review = doc.data();
    total += review.rating;
    count++;

    container.innerHTML += `
      <div class="review-card">
        <h4>${maskName(review.name)}</h4>
        <p>${"‚≠ê".repeat(review.rating)}</p>
        <p>${review.text}</p>
      </div>
    `;
  });

  if(count>0){
    document.getElementById("averageRating").innerText =
      (total/count).toFixed(1);
  }
}

loadReviews();

document.getElementById("reviewForm")
.addEventListener("submit", async function(e){

  e.preventDefault();

  if(selectedRating==0){
    alert("Please select rating ‚≠ê");
    return;
  }

  await addDoc(collection(db,"reviews"),{
    name: document.getElementById("name").value,
    rating: parseInt(selectedRating),
    text: document.getElementById("reviewText").value,
    createdAt: new Date()
  });

  document.getElementById("reviewForm").reset();
  stars.forEach(s=>s.classList.remove("active"));
  selectedRating = 0;

  loadReviews();
});

/* ================= SPIN WHEEL SYSTEM ================= */

const promoPopup = document.getElementById("promoPopup");
const wheel = document.getElementById("wheel");
const spinBtn = document.getElementById("spinBtn");
const closePromo = document.getElementById("closePromo");

function openPromo(){
  promoPopup.style.display="flex";
}

function closePromoBox(){
  promoPopup.style.display="none";
}

closePromo.addEventListener("click", closePromoBox);

/* Auto open on first load */
if(!localStorage.getItem("promoClosed")){
  setTimeout(openPromo,800);
}

spinBtn.addEventListener("click", async ()=>{

  const today = new Date().toDateString();

  if(localStorage.getItem("spinDate") === today){
    alert("You already used your spin today üéÅ");
    return;
  }

  spinBtn.disabled = true;

  const random = Math.random();
  let result = "";
  let rotation = 0;

  // 50% WIN TOTAL
  if(random < 0.5){

      // RARE 20%
      if(random < 0.05){
          result = "20% OFF";
          rotation = 1440 + 90;
      }
      // 10%
      else if(random < 0.25){
          result = "10% OFF";
          rotation = 1440 + 180;
      }
      // 5%
      else{
          result = "5% OFF";
          rotation = 1440 + 270;
      }

      launchConfetti();
      saveWinner(result);

      alert("üéâ YOU WON " + result + "!\nScreenshot and message us üíú");

  } else {
      result = "LOSE";
      rotation = 1440 + 360;
      alert("No luck today üò¢ Try again tomorrow!");
  }

  wheel.style.transform = `rotate(${rotation}deg)`;

  localStorage.setItem("spinDate", today);

  setTimeout(()=>{
    spinBtn.disabled = false;
  },4000);
});

/* Save winner to Firestore */
async function saveWinner(prize){

  const code = "PC" + Math.floor(100000 + Math.random()*900000);

  await addDoc(collection(db,"winners"),{
    code: code,
    prize: prize,
    createdAt: new Date()
  });
}

/* ================= CONFETTI ================= */

function launchConfetti(){

  const duration = 2000;
  const end = Date.now() + duration;

  const interval = setInterval(()=>{

    if(Date.now() > end){
      clearInterval(interval);
      return;
    }

    const confetti = document.createElement("div");
    confetti.style.position="fixed";
    confetti.style.width="8px";
    confetti.style.height="8px";
    confetti.style.background="hsl("+Math.random()*360+",100%,50%)";
    confetti.style.left=Math.random()*window.innerWidth+"px";
    confetti.style.top="-10px";
    confetti.style.zIndex="99999";
    confetti.style.borderRadius="50%";

    document.body.appendChild(confetti);

    let fall = setInterval(()=>{
      confetti.style.top =
        parseInt(confetti.style.top)+5+"px";

      if(parseInt(confetti.style.top) > window.innerHeight){
        clearInterval(fall);
        confetti.remove();
      }
    },20);

  },100);
}

</script>

</body>
</html>
